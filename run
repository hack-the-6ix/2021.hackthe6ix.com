#!/bin/bash

declare -A tags
tags["development"]=ht6/dev-landing-2021:latest
tags["production"]=ht6/landing-2021:latest


function build() {
    local target=${1:-development};
    docker build --target $target -t ${tags[$target]} .;
}

function dev() {
    build development;
    docker run \
        -v ${PWD}/static:/usr/var/app/static \
        -v ${PWD}/src:/usr/var/app/static \
        -p 8080:8080 \
        -it \
        ${tags[development]};
}

function debug() {
    docker exec -it $1 /bin/sh;
}

function prod() {
    build production;
    docker run \
        -v ${PWD}/dist:/usr/var/app/dist \
        -it \
        ${tags[production]};
}

eval "$@ && exit 0";